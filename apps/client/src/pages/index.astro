---
import Welcome from '../components/Welcome.astro';
import Layout from '../layouts/Layout.astro';

const SERVER_API_URL = import.meta.env.SERVER_API_URL;
let data = null;
let error = null;

try {
  const serverData = await fetch(`${SERVER_API_URL}/api/users`);
  if (!serverData.ok) {
    throw new Error(`Failed to fetch data from server: ${serverData.statusText}`);
  }
  const serverDataJson = await serverData.json();
  data = serverDataJson;
} catch (error) {
  console.error(error);
  if (error instanceof Error) {
    error = error.message;
  }
}
---

<Layout>
	<Welcome>
    <div>
      <h1>Hello from Cronos Testing App</h1>
      <p>Server API URL: {SERVER_API_URL}</p>
      <pre>{JSON.stringify({data, error}, null, 2)}</pre>
    </div>
	</Welcome>
</Layout>
